{"version":3,"file":"BFormRating.vue_vue_type_script_setup_true_lang-9eNNL0_J.mjs","sources":["../src/components/BFormRating/BFormRating.vue"],"sourcesContent":["<template>\n  <div\n    :id=\"computedId\"\n    :class=\"computedClasses\"\n    role=\"slider\"\n    :aria-valuemin=\"0\"\n    :aria-valuemax=\"clampedStars\"\n    :aria-valuenow=\"displayValue\"\n    :aria-valuetext=\"`${displayValue} of ${clampedStars}`\"\n    tabindex=\"0\"\n    @keydown=\"onKeydown\"\n  >\n    <span\n      v-if=\"props.showClear && !props.readonly\"\n      class=\"clear-button-spacing\"\n      @click=\"clearRating\"\n    >\n      <svg\n        viewBox=\"0 0 16 16\"\n        role=\"img\"\n        aria-label=\"x\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        class=\"clear-icon\"\n      >\n        <g>\n          <path\n            d=\"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708\"\n          />\n        </g>\n      </svg>\n    </span>\n    <span\n      v-for=\"(starIndex, index) in clampedStars\"\n      :key=\"starIndex\"\n      class=\"star\"\n      @click=\"selectRating(starIndex)\"\n    >\n      <slot :star-index=\"starIndex\" :is-filled=\"isIconFull(index)\" :is-half=\"isIconHalf(index)\">\n        <span class=\"b-form-rating-star\">\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            :width=\"computedSize\"\n            :height=\"computedSize\"\n            fill=\"currentColor\"\n            :class=\"[iconColors[index].class]\"\n            :style=\"iconColors[index].style\"\n            class=\"star-spacing\"\n            viewBox=\"0 0 16 16\"\n          >\n            <path\n              v-if=\"isIconFull(index)\"\n              d=\"M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z\"\n            />\n            <path\n              v-else-if=\"isIconHalf(index)\"\n              d=\"M5.354 5.119 7.538.792A.52.52 0 0 1 8 .5c.183 0 .366.097.465.292l2.184 4.327 4.898.696A.54.54 0 0 1 16 6.32a.55.55 0 0 1-.17.445l-3.523 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256a.5.5 0 0 1-.146.05c-.342.06-.668-.254-.6-.642l.83-4.73L.173 6.765a.55.55 0 0 1-.172-.403.6.6 0 0 1 .085-.302.51.51 0 0 1 .37-.245zM8 12.027a.5.5 0 0 1 .232.056l3.686 1.894-.694-3.957a.56.56 0 0 1 .162-.505l2.907-2.77-4.052-.576a.53.53 0 0 1-.393-.288L8.001 2.223 8 2.226z\"\n            />\n            <path\n              v-else\n              d=\"M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.522 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z\"\n            />\n          </svg>\n        </span>\n      </slot>\n    </span>\n\n    <span\n      v-if=\"props.showValue || props.showValueMax\"\n      :style=\"{fontSize: computedSize}\"\n      class=\"rating-value-text\"\n    >\n      {{ displayValueText }}\n    </span>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {computed, defineSlots, ref} from 'vue'\nimport {useDefaults} from '../../composables/useDefaults'\nimport type {BFormRatingProps} from '../../types/ComponentProps'\nimport {useId} from '../../composables/useId'\n\nconst _props = withDefaults(defineProps<Omit<BFormRatingProps, 'modelValue'>>(), {\n  color: '',\n  id: undefined,\n  inline: false,\n  noBorder: false,\n  precision: 0,\n  readonly: false,\n  showClear: false,\n  showValue: false,\n  showValueMax: false,\n  size: '1rem',\n  stars: 5,\n  variant: undefined,\n})\nconst props = useDefaults(_props, 'BFormRating')\n\nconst computedId = useId(() => props.id, 'form-rating')\n\nconst computedClasses = computed(() => ({\n  'is-readonly': props.readonly,\n  'no-border': props.noBorder,\n  'b-form-rating': true,\n  'd-inline-block': props.inline,\n  'w-100': !props.inline,\n}))\n\ndefineSlots<{\n  default?: (props: {\n    starIndex: number\n    isFilled: boolean\n    isHalf: boolean\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }) => any\n}>()\n\nconst modelValue = defineModel<Exclude<BFormRatingProps['modelValue'], undefined>>({default: 0})\n\nfunction isIconFull(index: number): boolean {\n  return displayValue.value - index >= 1\n}\n\nfunction isIconHalf(index: number): boolean {\n  const diff = displayValue.value - index\n  return diff >= 0.5 && diff < 1\n}\n\nconst hoverValue = ref<number | null>(null)\n\nconst localValue = computed({\n  get: () => modelValue.value,\n  set: (value: number) => {\n    modelValue.value = value\n  },\n})\n\nconst displayValue = computed(() =>\n  hoverValue.value !== null ? hoverValue.value : localValue.value\n)\n\n// Set the minimum amount of star can be render to 3\nconst clampedStars = computed(() => Math.max(3, props.stars))\n\nconst computedSize = computed(() => {\n  if (props.size === 'sm') return '.875rem'\n  if (props.size === 'lg') return '1.25rem'\n  return props.size\n})\n\nconst displayValueText = computed(() => {\n  const decimalValue = props.precision > 0 ? roundedValue.value : displayValue.value\n  if (props.showValueMax) {\n    return `${decimalValue}/${clampedStars.value}`\n  }\n  if (props.showValue) {\n    return `${decimalValue}`\n  }\n  return ''\n})\n\nconst roundedValue = computed(() => {\n  const val = displayValue.value\n  const factor = 10 ** props.precision\n  return Math.round((val + Number.EPSILON) * factor) / factor\n})\n\nconst iconColors = computed(() =>\n  Array.from({length: clampedStars.value}, () => {\n    if (props.variant) {\n      return {class: `text-${props.variant}`, style: {}}\n    }\n    if (props.color) {\n      return {class: '', style: {color: props.color}}\n    }\n    return {class: '', style: {}}\n  })\n)\n\n//add keyboard support\nfunction onKeydown(e: KeyboardEvent) {\n  if (props.readonly) return\n\n  let newValue = localValue.value\n\n  switch (e.key) {\n    case 'ArrowRight':\n    case 'ArrowUp':\n      newValue = Math.min(newValue + 1, clampedStars.value)\n      break\n    case 'ArrowLeft':\n    case 'ArrowDown':\n      newValue = Math.max(newValue - 1, 0)\n      break\n    default:\n      return\n  }\n\n  e.preventDefault()\n  localValue.value = newValue\n}\n\nfunction selectRating(starIndex: number) {\n  if (props.readonly) return\n  const selectedRating = hoverValue.value !== null ? hoverValue.value : starIndex\n  localValue.value = selectedRating\n}\n\n// clear\nfunction clearRating() {\n  hoverValue.value = null\n  localValue.value = 0\n}\n\ndefineExpose({\n  hoverValue,\n})\n</script>\n"],"names":["_useModel"],"mappings":"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"}